[{"path":"https://dipterix.org/spfda/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zhengjia Wang. Author, maintainer. Meng Li. Author.","code":""},{"path":"https://dipterix.org/spfda/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang, Z, Magnotti, JF, Beauchamp, MS. Li, M, Functional Group Bridge Simultaneous Regression Support Estimation.","code":"@Article{,   title = {Functional Group Bridge for Simultaneous Regression and Support Estimation},   author = {Zhengjia Wang and John F. Magnotti and Michael S. Beauchamp and Meng Li},   journal = {arXiv},   year = {2020}, }"},{"path":"https://dipterix.org/spfda/index.html","id":"r-package-spfda---sparse-function-on-scalar-regression","dir":"","previous_headings":"","what":"Function-on-Scalar Regression with Group-Bridge Penalty","title":"Function-on-Scalar Regression with Group-Bridge Penalty","text":"package implements paper “Functional Group Bridge Simultaneous Regression Support Estimation” [PDF] [Github] [CRAN] [Examples]","code":""},{"path":"https://dipterix.org/spfda/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Function-on-Scalar Regression with Group-Bridge Penalty","text":"can install released version spfda  CRAN : experimental version can installed via","code":"install.packages(\"spfda\") # install.packages(\"remotes\") remotes::install_github(\"dipterix/spfda\")"},{"path":"https://dipterix.org/spfda/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Function-on-Scalar Regression with Group-Bridge Penalty","text":"","code":"library(spfda) dat <- spfda_simulate() x <- dat$X y <- dat$Y  ## basic example code  fit <- spfda(y, x, lambda = 5, CI = TRUE)  ## Generics  BIC(fit) plot(fit, col = c(\"orange\", \"dodgerblue3\", \"darkgreen\"),      main = \"Fitted with 95% CI\", aty = c(0, 0.5, 1), atx = c(0,0.2,0.8,1)) matpoints(fit$time, t(dat$env$beta), type = 'l', col = 'black', lty = 2) legend('topleft', c(\"Fitted\", \"Underlying\"), lty = c(1,2), bty = 'n') print(fit) coefficients(fit)"},{"path":"https://dipterix.org/spfda/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Function-on-Scalar Regression with Group-Bridge Penalty","text":"Use citation('spfda') generate citation information, check link.","code":"Wang, Z, Magnotti, JF, Beauchamp, MS. Li, M, Functional Group Bridge for   Simultaneous Regression and Support Estimation."},{"path":"https://dipterix.org/spfda/reference/fosr_vs.html","id":null,"dir":"Reference","previous_headings":"","what":"Ported function from 'refund' package — fosr_vs","title":"Ported function from 'refund' package — fosr_vs","text":"modified version fosr.vs, groups parameter allow grouping time points rather whole coefficient underlying functions locally supported.","code":""},{"path":"https://dipterix.org/spfda/reference/fosr_vs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ported function from 'refund' package — fosr_vs","text":"","code":"fosr_vs(   formula,   data,   nbasis = 10,   method = c(\"ls\", \"grLasso\", \"grMCP\", \"grSCAD\"),   epsilon = 1e-05,   max.iter_num = 100,   groups = NULL )"},{"path":"https://dipterix.org/spfda/reference/fosr_vs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ported function from 'refund' package — fosr_vs","text":"formula, data, nbasis, method, epsilon, max.iter_num see fosr.vs groups integer vector length number time-points time-points grouped; default NULL, indicating local sparsity.","code":""},{"path":"https://dipterix.org/spfda/reference/spfda.html","id":null,"dir":"Reference","previous_headings":"","what":"Sparse Function-on-scalar Regression with Group Bridge Penalty — spfda","title":"Sparse Function-on-scalar Regression with Group Bridge Penalty — spfda","text":"Function--scalar regression model, denote \\(n\\) total number observations, \\(p\\) number coefficients, \\(K\\) number B-splines, \\(T\\) total time points.","code":""},{"path":"https://dipterix.org/spfda/reference/spfda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sparse Function-on-scalar Regression with Group Bridge Penalty — spfda","text":"","code":"spfda(   Y,   X,   lambda,   time = seq(0, 1, length.out = ncol(Y)),   nsp = \"auto\",   ord = 4,   alpha = 0.5,   W = NULL,   init = NULL,   max_iter = 50,   inner_iter = 50,   CI = FALSE,   ... )"},{"path":"https://dipterix.org/spfda/reference/spfda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sparse Function-on-scalar Regression with Group Bridge Penalty — spfda","text":"Y Numeric \\(n \\times T\\) matrix, response function. X Numeric \\(n \\times p\\) matrix, design matrix lambda Regularization parameter \\(\\gamma\\) time Time domain, numerical length \\(T\\) nsp Integer 'auto', number B-splines \\(K\\); default 'auto' ord B-spline order, default 4; must \\(\\geq 3\\) alpha Bridge parameter \\(\\alpha\\), default 0.5 W \\(T \\times T\\) weight matrix NULL (identity matrix); default NULL init Initial \\(\\gamma\\); default NULL max_iter Number outer iterations inner_iter Number \\(ADMM\\) iterations (inner steps) CI Logical, whether calculate theoretical confidence intervals ... Ignored","code":""},{"path":"https://dipterix.org/spfda/reference/spfda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sparse Function-on-scalar Regression with Group Bridge Penalty — spfda","text":"spfda.model object (environment) following elements: B B-spline basis functions used error Root Mean Square Error ('RMSE') CI Whether confidence intervals calculated gamma B-spline coefficient \\(\\gamma_{p \\times K}\\) generate_splines Function generate B-splines given time points K Number B-spline basis functions knots B-spline knots used fit model predict Function predict responses \\(\\beta(t)\\) given new   X /time points raw list raw variables","code":""},{"path":"https://dipterix.org/spfda/reference/spfda.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sparse Function-on-scalar Regression with Group Bridge Penalty — spfda","text":"function implements \"Functional Group Bridge Simultaneous Regression Support Estimation\" (https://arxiv.org/abs/2006.10163). model estimates functional coefficients \\(\\beta(t)\\) model \\[y(t) = X\\beta(t) + \\epsilon(t)\\] B-spline basis expansion \\[\\beta(t) = \\gamma B(t) + R(t), \\] \\( R(t) \\) B-spline approximation error. objective function \\[ \\left\\| (Y-X\\gamma B)W \\right\\|_{2}^{2} + \\sum_{j,m} \\left\\| \\gamma_{j}^{T}\\mathbf{1}(B^{t} > 0) \\right\\|_{1}^{\\alpha}. \\] input response variable matrix. \\(y_{}(t)\\) observed different time points, please interpolate (e.g. kernel) feeding .","code":""},{"path":"https://dipterix.org/spfda/reference/spfda.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sparse Function-on-scalar Regression with Group Bridge Penalty — spfda","text":"","code":"dat <- spfda_simulate() x <- dat$X y <- dat$Y  fit <- spfda(y, x, lambda = 5, CI = TRUE)  BIC(fit) #> [1] 102.5317  plot(fit, col = c(\"orange\", \"dodgerblue3\", \"darkgreen\"),      main = \"Fitted with 95% CI\", aty = c(0, 0.5, 1), atx = c(0,0.2,0.8,1)) matpoints(fit$time, t(dat$env$beta), type = 'l', col = 'black', lty = 2) legend('topleft', c(\"Fitted\", \"Underlying\"), lty = c(1,2))   print(fit) #> Model: function-on-scalar with group-bridge penalty #> Log-lik: -50042.13 (df=260) #> E-BIC:   102.5317 #> RMSE :   1.068463 #> Parameters: #>  K:      50 #>  alpha:  0.5 #>  lambda: 5 coefficients(fit) #>               [,1]         [,2]         [,3]         [,4]         [,5] #> [1,] -7.862945e-07 1.712436e-06 2.852113e-06 3.477172e-06 3.818059e-06 #> [2,]  0.000000e+00 2.922837e-02 7.746294e-02 9.444562e-02 9.582577e-02 #> [3,] -2.757821e-06 1.580555e-06 1.663040e-06 1.010232e-06 7.826380e-07 #>              [,6]         [,7]         [,8]         [,9]        [,10] #> [1,] 3.825047e-06 3.372612e-06 2.292389e-06 9.785956e-07 5.552202e-07 #> [2,] 1.239090e-01 1.779923e-01 2.247257e-01 2.519890e-01 2.763188e-01 #> [3,] 1.064108e-06 1.651406e-06 2.132294e-06 2.406164e-06 2.783026e-06 #>             [,11]        [,12]        [,13]        [,14]        [,15] #> [1,] 1.566090e-06 3.151363e-06 4.339476e-06 4.471688e-06 3.140604e-06 #> [2,] 3.093559e-01 3.475397e-01 3.852971e-01 4.172321e-01 4.392639e-01 #> [3,] 3.290937e-06 3.267436e-06 2.247530e-06 9.298384e-07 1.849375e-07 #>             [,16]        [,17]        [,18]        [,19]        [,20] #> [1,] 1.218485e-06 8.642402e-08 1.599677e-07 1.106017e-06 2.444568e-06 #> [2,] 4.567033e-01 4.784300e-01 5.037582e-01 5.248865e-01 5.440472e-01 #> [3,] 4.313412e-09 0.000000e+00 0.000000e+00 1.808391e-04 7.753477e-03 #>             [,21]        [,22]        [,23]        [,24]        [,25] #> [1,] 3.530519e-06 3.884078e-06 3.419031e-06 2.215971e-06 8.097169e-07 #> [2,] 5.766874e-01 6.253107e-01 6.615610e-01 6.651590e-01 6.648342e-01 #> [3,] 3.901124e-02 1.002559e-01 1.741348e-01 2.449419e-01 3.163592e-01 #>              [,26]         [,27]         [,28]         [,29]        [,30] #> [1,] -2.099710e-07 -6.865558e-07 -6.659158e-07 -3.181990e-07 9.706464e-08 #> [2,]  6.946893e-01  7.379873e-01  7.577807e-01  7.555608e-01 7.619630e-01 #> [3,]  3.949234e-01  4.724481e-01  5.354086e-01  5.891144e-01 6.529892e-01 #>             [,31]        [,32]        [,33]        [,34]        [,35] #> [1,] 5.346865e-07 1.230251e-06 2.260742e-06 3.307293e-06 4.039758e-06 #> [2,] 7.878243e-01 8.173040e-01 8.396148e-01 8.592281e-01 8.797865e-01 #> [3,] 7.309817e-01 8.064662e-01 8.644059e-01 8.963792e-01 9.018859e-01 #>             [,36]        [,37]        [,38]        [,39]        [,40] #> [1,] 4.297129e-06 3.984566e-06 3.183760e-06 2.064772e-06 9.364431e-07 #> [2,] 8.933599e-01 8.922352e-01 8.916876e-01 9.151255e-01 9.535413e-01 #> [3,] 9.085318e-01 9.444096e-01 9.892825e-01 1.003887e+00 9.882876e-01 #>             [,41]         [,42]         [,43]         [,44]    [,45]    [,46] #> [1,] 2.064137e-07 -1.612533e-08 -1.281367e-08 -1.601709e-09 0.000000 0.000000 #> [2,] 9.736533e-01  9.694390e-01  9.710424e-01  9.942474e-01 1.017394 1.020100 #> [3,] 9.725012e-01  9.717871e-01  9.812247e-01  9.957805e-01 1.013178 1.029997 #>         [,47]     [,48]     [,49]     [,50]     [,51]     [,52]     [,53] #> [1,] 0.000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 #> [2,] 1.007362 0.9902674 0.9780504 0.9782572 0.9856369 0.9854002 0.9745564 #> [3,] 1.036751 1.0250389 1.0057034 0.9972092 1.0030836 1.0153099 1.0250618 #>             [,54]        [,55]        [,56]        [,57]        [,58] #> [1,] 3.417246e-10 7.381252e-08 4.548355e-07 1.228842e-06 1.797813e-06 #> [2,] 9.657484e-01 9.677216e-01 9.781920e-01 9.920147e-01 9.985696e-01 #> [3,] 1.022875e+00 1.005024e+00 9.806920e-01 9.612470e-01 9.598079e-01 #>             [,59]        [,60]        [,61]        [,62]     [,63]     [,64] #> [1,] 1.524092e-06 7.398338e-07 1.749630e-07 9.226565e-09 0.0000000 0.0000000 #> [2,] 9.879958e-01 9.661590e-01 9.455300e-01 9.319814e-01 0.9261678 0.9242315 #> [3,] 9.858781e-01 1.019000e+00 1.027207e+00 1.007167e+00 0.9774607 0.9501774 #>          [,65]     [,66]     [,67]     [,68]     [,69]     [,70]     [,71] #> [1,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 #> [2,] 0.9166495 0.8991299 0.8799002 0.8659747 0.8527369 0.8337324 0.8104096 #> [3,] 0.9282070 0.9084398 0.8757469 0.8204099 0.7608577 0.7178032 0.6768302 #>              [,72]         [,73]         [,74]         [,75]         [,76] #> [1,] -2.353999e-08 -4.463881e-07 -1.887559e-06 -3.888458e-06 -4.586812e-06 #> [2,]  7.873750e-01  7.634965e-01  7.334011e-01  6.989441e-01  6.714858e-01 #> [3,]  6.101011e-01  5.244660e-01  4.528608e-01  4.026884e-01  3.473482e-01 #>              [,77]         [,78]         [,79]         [,80]       [,81] #> [1,] -3.135179e-06 -1.160435e-06 -1.883200e-07 -8.718517e-10 0.000000000 #> [2,]  6.560134e-01  6.418733e-01  6.207960e-01  6.025152e-01 0.597628588 #> [3,]  2.704374e-01  1.833840e-01  1.012731e-01  3.875723e-02 0.007702364 #>             [,82]        [,83]        [,84]        [,85]        [,86] #> [1,] 0.0000000000 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 #> [2,] 0.5898578752 5.530440e-01 4.933727e-01 4.414725e-01 4.091773e-01 #> [3,] 0.0001814535 2.429327e-06 2.855362e-06 3.522591e-06 4.265162e-06 #>             [,87]       [,88]      [,89]      [,90]      [,91]      [,92] #> [1,] 0.000000e+00 0.000000000 0.00000000 0.00000000 0.00000000 0.00000000 #> [2,] 3.830920e-01 0.352168566 0.31436030 0.27191696 0.23940235 0.23013977 #> [3,] 1.625189e-05 0.002616067 0.01610419 0.04350613 0.06364961 0.05395874 #>           [,93]       [,94]        [,95]      [,96]      [,97]         [,98] #> [1,] 0.00000000 0.000000000 0.0000000000 0.00000000 0.00000000 -2.055809e-05 #> [2,] 0.22553270 0.194956505 0.1418116596 0.09525509 0.06614346  4.069437e-02 #> [3,] 0.02619296 0.006194364 0.0003266559 0.00000000 0.00000000  4.345454e-05 #>             [,99]      [,100] #> [1,] -0.004440547 -0.02736281 #> [2,]  0.005723567 -0.04694303 #> [3,]  0.009386181  0.05783799"},{"path":"https://dipterix.org/spfda/reference/spfda_simulate.html","id":null,"dir":"Reference","previous_headings":"","what":"Generates toy example data — spfda_simulate","title":"Generates toy example data — spfda_simulate","text":"Synthesized functional signals heterogeneous error. underlying three coefficients correspond 'dense', 'global sparse', 'local sparse' functions. See https://arxiv.org/abs/2006.10163 detailed configurations.","code":""},{"path":"https://dipterix.org/spfda/reference/spfda_simulate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generates toy example data — spfda_simulate","text":"","code":"spfda_simulate(n = 1000, n_timepoints = 100, err = 1, scale = c(1, 1, 1))"},{"path":"https://dipterix.org/spfda/reference/spfda_simulate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generates toy example data — spfda_simulate","text":"n Total number observations n_timepoints Total number time points err Error magnitude scale scale coefficients length 1 3.","code":""},{"path":"https://dipterix.org/spfda/reference/spfda_simulate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generates toy example data — spfda_simulate","text":"list data generated: X scalar predictor, Y functional response.","code":""},{"path":"https://dipterix.org/spfda/reference/spfda_weight.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculates weight matrices — spfda_weight","title":"Calculates weight matrices — spfda_weight","text":"Calculates weight matrices","code":""},{"path":"https://dipterix.org/spfda/reference/spfda_weight.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculates weight matrices — spfda_weight","text":"","code":"spfda_weight(X, Y, bandwidth, part)"},{"path":"https://dipterix.org/spfda/reference/spfda_weight.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculates weight matrices — spfda_weight","text":"X design matrix Y response matrix bandwidth numeric band-width part list time point boundaries","code":""},{"path":"https://dipterix.org/spfda/reference/spfda_weight.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculates weight matrices — spfda_weight","text":"weight matrix","code":""},{"path":"https://dipterix.org/spfda/news/index.html","id":"spfda-091","dir":"Changelog","previous_headings":"","what":"spfda 0.9.1","title":"spfda 0.9.1","text":"CRAN release: 2022-03-18 Added functions calculate weights Simplified algorithm, lowered computation complexity Allow threshold calculating EBIC Added get_se result object Added comparing methods","code":""},{"path":"https://dipterix.org/spfda/news/index.html","id":"spfda-090","dir":"Changelog","previous_headings":"","what":"spfda 0.9.0","title":"spfda 0.9.0","text":"CRAN release: 2020-11-25 Initial beta release!","code":""}]
